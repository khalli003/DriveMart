<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Управление Компаниями</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <h1>Управление Компаниями</h1>

    <form id="companyForm">
        <div class="form-group">
            <label for="name">Название Компании</label>
            <input type="text" class="form-control" id="name" required>
        </div>
        <div class="form-group">
            <label for="registrationNumber">Регистрационный Номер</label>
            <input type="text" class="form-control" id="registrationNumber" required>
        </div>
        <div class="form-group">
            <label for="balance">Баланс</label>
            <input type="number" class="form-control" id="balance" value="0" step="0.01" required>
        </div>
        <div class="form-group">
            <label for="address">Адрес</label>
            <input type="text" class="form-control" id="address" required>
        </div>
        <button type="submit" class="btn btn-primary">Добавить Компанию</button>
    </form>

    <h2>Список Компаний</h2>
    <table class="table table-bordered" id="companyTable">
        <thead>
        <tr>
            <th>ID</th>
            <th>Название</th>
            <th>Регистрационный Номер</th>
            <th>Баланс</th>
            <th>Адрес</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const apiUrl = '/companies';

    // Функция для отображения компаний
    function fetchCompanies() {
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                const tableBody = document.getElementById('companyTable').getElementsByTagName('tbody')[0];
                tableBody.innerHTML = ''; // Очищаем таблицу
                data.forEach(company => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${company.id}</td>
                        <td>${company.name}</td>
                        <td>${company.registrationNumber}</td>
                        <td>${company.balance}</td>
                        <td>${company.address}</td>
                        <td>
                            <button onclick="deleteCompany(${company.id})" class="btn btn-danger">Удалить</button>
                            <button onclick="getCompanyCars(${company.id})" class="btn btn-info">Автомобили</button>
                        </td>
                    `;
                });
            });
    }

    // Функция для добавления компании
    document.getElementById('companyForm').addEventListener('submit', function (e) {
        e.preventDefault();
        const newCompany = {
            name: document.getElementById('name').value,
            registrationNumber: document.getElementById('registrationNumber').value,
            balance: parseFloat(document.getElementById('balance').value),
            address: document.getElementById('address').value
        };

        fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(newCompany)
        })
            .then(response => response.json())
            .then(() => {
                document.getElementById('companyForm').reset(); // Очистить форму
                fetchCompanies(); // Обновить список компаний
            });
    });

    // Функция для удаления компании
    function deleteCompany(id) {
        fetch(`${apiUrl}/${id}`, {
            method: 'DELETE'
        })
            .then(() => {
                fetchCompanies(); // Обновить список компаний после удаления
            });
    }

    // Функция для получения автомобилей компании
    function getCompanyCars(companyId) {
        fetch(`${apiUrl}/${companyId}/cars`)
            .then(response => response.json())
            .then(cars => {
                if (Array.isArray(cars)) {
                    alert(`Автомобили компании: ${cars.map(car => car.licensePlate).join(', ')}`);
                } else {
                    alert('Нет автомобилей или компания не найдена.');
                }
            });
    }

    // Инициализация
    fetchCompanies();
</script>
</body>
</html>
l>